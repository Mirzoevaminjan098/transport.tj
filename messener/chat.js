var lang=document.location.href.split("/")[3]||"he",chatLang="he"==lang?"he-il":lang,resource={title:"",placeholder:"",message:"",moreInfo:""};const url=`${window.govilRunConfig.headerFooterUrl}govilHF/api/GetChatResource`,xhr=new XMLHttpRequest;xhr.open("GET",`${url}?culture=${lang}`),xhr.setRequestHeader("Content-Type","application/json");let chatBubble="";var leftOrRight,anchor;switch(xhr.onload=function(){if(200===xhr.status){if(resource=JSON.parse(xhr.responseText),chatBubble=document.getElementsByTagName("df-messenger-chat-bubble")[0],!chatBubble.shadowRoot.childNodes[2].getElementsByTagName("div")[0].getElementsByTagName("df-messenger-chat")[0].shadowRoot.childNodes[2].getElementsByTagName("div")[0].childNodes[6].shadowRoot.childNodes[4].getElementsByClassName("content")[0].getElementsByClassName("entry bot")[0]){const e=document.querySelector("df-messenger"),t=`<span>${resource.message}\n            <a target='blank' href='https://www.gov.il/${lang}/Departments/General/gov_terms_of_use'>${resource.moreInfo}</a>\n            </span>`;e.renderCustomText(t)}if(chatBubble&&(chatBubble.setAttribute("placeholder-text",resource.placeholder),chatBubble.setAttribute("chat-title",resource.title),"he"==lang||"ar"==lang)){let e=chatBubble.shadowRoot.childNodes[2].getElementsByClassName("chat-wrapper")[0].getElementsByTagName("df-messenger-chat")[0].shadowRoot.childNodes[2].getElementsByTagName("df-messenger-user-input")[0].shadowRoot.childNodes[4].getElementsByClassName("input-box-wrapper")[0];e.style.cssText="overflow: hidden",e.getElementsByClassName("send-icon-button-wrapper")[0].style.cssText="transform: rotate(180deg)"}}else console.error(xhr.statusText)},xhr.send(),xhr.onloadend=function(){let e=chatBubble.shadowRoot.childNodes[2].getElementsByTagName("div")[0].getElementsByTagName("df-messenger-chat")[0].shadowRoot.childNodes[2].getElementsByTagName("div")[0].childNodes[6].shadowRoot.childNodes[4].getElementsByClassName("content")[0].getElementsByClassName("entry bot")[0].childNodes[5].shadowRoot.childNodes[5].getElementsByTagName("df-markdown-message")[0].shadowRoot.childNodes[6].getElementsByTagName("a")[0];e.id="chat_more_info_link",e.target="blank",e.style.cssText="padding:0; border:none"},lang){case"he":case"ar":leftOrRight="left:  16px;",anchor="top-right";break;case"en":case"ru":case"fr":case"es":leftOrRight="right:  16px;",anchor="top-left"}document.body.innerHTML+=`<df-messenger\n            project-id="dgt-gcp-egov-chatbot-dev" agent-id="8a7938b2-221e-42af-96f0-5e0d1326ed14"\n            language-code="${chatLang}" max-query-length="-1" allow-feedback="all">\n             <df-messenger-chat-bubble anchor="${anchor}"\n             placeholder-text="${resource.placeholder}" chat-title="${resource.title}"></df-messenger-chat-bubble>\n            </df-messenger>\n            <style>\n             df-messenger {\n             --df-messenger-button-titlebar-color: #0068F5;\n             --df-messenger-font-color: #0C3058;\n             z-index: 999;\n             position: fixed;\n             bottom: 16px;\n              ${leftOrRight}\n            }\n            </style>`,window.addEventListener("df-user-input-entered",(e=>{"he"!=lang&&"ar"!=lang||(e.target.shadowRoot.childNodes[2].getElementsByTagName("df-messenger-chat")["df-chat-wrapper"].shadowRoot.childNodes[2].getElementsByClassName("message-list-wrapper")[0].getElementsByTagName("df-messenger-message-list")[0].shadowRoot.childNodes[4].getElementsByClassName("content")[0].style.alignItems="flex-start")}));class CustomFeedbackElement extends HTMLElement{constructor(){super(),this.renderRoot=this.attachShadow({mode:"open"})}connectedCallback(){const e=document.createElement("div");e.className="feedback feedback-box";const t=document.createElement("div");t.className="feedback-title-row",t.style.cssText="display: flex; justify-content: space-between; margin:10px";const s=document.createElement("div");s.style.cssText="display:flex; flex-direction:column";const a=document.createElement("span");a.id="feedback_title",a.className="feedback-title",a.innerText=resource.feedbackTitle,a.style.fontWeight="bold";const n=document.createElement("span");n.id="feedback_subtitle",n.className="feedback-sub-title",n.innerText=resource.feedbackSubTitle,n.style.fontWeight="400",n.style.fontSize="12px";const o=document.createElement("button");o.id="feedback_close_button",o.className="feedback-close focus-outline action-button",o.part="feedbackCloseButton",o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>\n            <path d="M0 0h24v24H0z" fill="none"></path></svg>',o.style.cssText="border:none; padding:0px; background-color:transparent; fill: var(--df-messenger-icon-font-color, var(--df-messenger-default-icon-font-color))",s.appendChild(a),s.appendChild(n),t.appendChild(s),t.appendChild(o);const r=document.createElement("div");r.className="options feedback-reason-row",r.style.cssText="display:flex; flex-wrap:wrap; flex-direction:var(--df-messenger-message-rich-feedback-chips-flex-direction, row);\n            row-gap:var(--df-messenger-message-rich-feedback-chips-spacing, 10px); justify-content:space-around";const d=document.createElement("button");d.className="options feedback-reason-chip focus-outline",d.id="option_1",d.innerText=resource.reasonOptions[0],d.style.cssText="border: var(--df-messenger-default-border); border-radius: 8px; padding:8px 16px; background:transparent";const c=document.createElement("button");c.id="option_2",c.className="options feedback-reason-chip focus-outline",c.innerText=resource.reasonOptions[1],c.style.cssText="border: var(--df-messenger-default-border); border-radius: 8px; padding:8px 16px;background:transparent";const l=document.createElement("button");l.id="option_3",l.className="options feedback-reason-chip focus-outline",l.innerText=resource.reasonOptions[2],l.style.cssText="border: var(--df-messenger-default-border); border-radius: 8px; padding:8px 16px;background:transparent",r.appendChild(d),r.appendChild(c),r.appendChild(l);let i=null;const m=document.createElement("div");m.className="textarea-row ",m.style.cssText="position: relative; display:flex; margin: 10px 5px";const p=document.createElement("textarea");p.id="feedback_additional",p.className=" focus-outline action-button",p.rows=1,p.placeholder=resource.additionalFeedback,p.style.cssText="resize: none;box-sizing: border-box; border:var(--df-messenger-default-border); border-radius: var(--df-messenger-default-border-radius);\n            background: var(--df-messenger-message-rich-feedback-input-background, #fff); color: var(--df-messenger-message-rich-feedback-input-font-color, inherit); \n            padding: 8px 16px; font-family: inherit; font-size: inherit; flex-grow:1",p.addEventListener("focus",(()=>{p.style.borderColor="#0068F5",p.style.outline="none"}));let u=p.value;p.addEventListener("blur",(()=>{u=p.value,p.style.border="var(--df-messenger-default-border)",""==u?(b.disabled="true",b.style.opacity="0.5"):(b.removeAttribute("disabled"),b.style.opacity="1")})),m.appendChild(p);const h=document.createElement("div"),g=document.createElement("span");g.id="privacy_notice",g.className="privacy-notice-row",g.innerText=resource.notice,g.style.cssText="padding: 0px 17px; font-size:12px; color:var(--df-messenger-message-rich-feedback-notice-font-color, var(--df-messenger-default-secondary-font-color)) ",h.appendChild(g);const f=document.createElement("div");f.style.cssText="display: flex; justify-content: flex-end;";const b=document.createElement("button");b.id="submit_button",b.innerText=resource.submit,b.className="feedback-submit focus-outline",b.style.cssText="left: 0px; padding: 8px 16px; margin: 5px; border-radius:8px; opacity:0.5;\n            color:var(--df-messenger-message-rich-feedback-chips-font-color,inherit);border:var(--df-messenger-default-border);",b.disabled="true",f.appendChild(b),b.addEventListener("click",(()=>{this._onSubmitClick(u,i.innerText)})),o.addEventListener("click",(e=>{e.target.getRootNode().host.parentElement.style.display="none"})),r.childNodes.forEach((e=>{e.addEventListener("click",(()=>{i&&(i.classList.remove("selected"),i.style.background="transparent",i.style.color="var(--df-messenger-message-rich-feedback-chips-font-color,inherit)",b.disabled="true",b.style.opacity="0.5"),i!=e&&(i=e,b.removeAttribute("disabled"),b.style.opacity="1",i.classList.add("selected"),i.style.background="var(--df-messenger-message-rich-feedback-chips-background-active, #e8f0fe)",i.style.color="var(--df-messenger-message-rich-feedback-chips-font-color-active, #174ea6)")}))})),e.appendChild(t),e.appendChild(r),e.appendChild(m),e.appendChild(h),e.appendChild(f),this.renderRoot.appendChild(e)}_onSubmitClick(e,t){const s=new CustomEvent("df-custom-submit-feedback-clicked",{detail:JSON.stringify({feedback:e,reasonLabels:t}),bubbles:!0,composed:!0});this.dispatchEvent(s)}}"en"!=lang&&customElements.define("df-external-custom-feedback",CustomFeedbackElement);